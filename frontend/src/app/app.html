<main class="min-h-screen bg-gray-50 py-8 px-4">
  <div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-10">
      <h1 class="text-4xl font-bold text-gray-900 mb-2">
        {{ title() }}
      </h1>
    </div>

    <!-- Toolbar with Add Button -->
    <mat-toolbar color="primary" class="mb-6 rounded-lg shadow-md">
      <span class="flex-1"></span> <!-- Spacer to push button to the right -->
      <button mat-raised-button color="accent" (click)="openAddUrlDialog()">
        <mat-icon>add</mat-icon>
        <span class="ml-2">Add URL</span>
      </button>
    </mat-toolbar>

    <!-- Loading State -->
    @if (loading()) {
      <div class="flex justify-center items-center py-20">
        <mat-spinner diameter="60"></mat-spinner>
      </div>
    }

    <!-- Error State -->
    @if (error()) {
      <div class="bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-lg text-center mb-8">
        <p class="font-medium">Error loading URLs</p>
        <p class="text-sm mt-1">{{ error() }}</p>
      </div>
    }

    <!-- URLs Table -->
    @if (urls().length > 0) {
      <mat-card class="shadow-xl">
        <mat-card-content class="p-0">
          <table mat-table [dataSource]="urls()" class="w-full">

            <!-- # Column -->
            <ng-container matColumnDef="index">
              <th mat-header-cell *matHeaderCellDef class="w-16">#</th>
              <td mat-cell *matCellDef="let element; let i = index">
                {{ i + 1 }}
              </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Name</th>
              <td mat-cell *matCellDef="let element" class="font-medium">
                {{ element.name || '-' }}
              </td>
            </ng-container>

            <!-- Original URL Column -->
            <ng-container matColumnDef="originalUrl">
              <th mat-header-cell *matHeaderCellDef>Original URL</th>
              <td mat-cell *matCellDef="let element" class="max-w-md">
                <a [href]="element.originalUrl"
                   target="_blank"
                   rel="noopener noreferrer"
                   class="text-blue-600 hover:text-blue-800 hover:underline truncate block">
                  {{ element.originalUrl }}
                </a>
              </td>
            </ng-container>

            <!-- Short Code Column -->
            <ng-container matColumnDef="shortCode">
              <th mat-header-cell *matHeaderCellDef>Short Code</th>
              <td mat-cell *matCellDef="let element">
                @if (element.shortCode) {
                  <code class="bg-gray-100 px-2 py-1 rounded text-sm">
                    {{ element.shortCode }}
                  </code>
                } @else {
                  <span class="text-gray-400 italic">â€”</span>
                }
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef class="text-right">Actions</th>
              <td mat-cell *matCellDef="let element" class="text-right">
                <button mat-icon-button
                        [cdkCopyToClipboard]="element.originalUrl"
                        matTooltip="Copy URL"
                        class="text-gray-600 hover:text-gray-900">
                  <mat-icon>content_copy</mat-icon>
                </button>
                <button mat-icon-button
                        matTooltip="Edit"
                        class="text-gray-600 hover:text-gray-900">
                  <mat-icon>edit</mat-icon>
                </button>
                <a [href]="element.originalUrl"
                   target="_blank"
                   rel="noopener noreferrer"
                   mat-icon-button
                   matTooltip="Open in new tab"
                   class="text-blue-600 hover:text-blue-800 ml-2">
                  <mat-icon>open_in_new</mat-icon>
                </a>
              </td>
            </ng-container>

            <!-- Header and Row Definitions -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"
                class="hover:bg-gray-50 transition"></tr>
          </table>

          <!-- No data message (fallback) -->
          <div class="text-center py-8 text-gray-500" *matNoDataRow>
            No URLs found
          </div>
        </mat-card-content>
      </mat-card>
    }

    <!-- Empty State -->
    @else if (!loading() && !error()) {
      <mat-card class="text-center py-20 shadow-lg">
        <mat-icon class="text-8xl text-gray-300 mb-6">link_off</mat-icon>
        <h2 class="text-2xl font-semibold text-gray-700 mb-2">No URLs found</h2>
        <p class="text-gray-500">The list is currently empty. Click the "Add URL" button to get started.</p>
      </mat-card>
    }
  </div>
</main>


<ng-template #myDialogTemplate>
  <h2 mat-dialog-title>URL Shortner Form</h2>
  <div mat-dialog-content>
    <p>This content is dynamically rendered from an <strong>ng-template</strong>!</p>
    <!-- Add any other components or HTML here -->
  </div>
  <div mat-dialog-actions>
    <button mat-button (click)="closeDialog()">Close</button>
  </div>
</ng-template>